{"ast":null,"code":"import _defineProperty from \"/Applications/MAMP/htdocs/react-lure-cart/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Applications/MAMP/htdocs/react-lure-cart/src/pages/Products/Products.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState, useRef, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Redirect } from 'react-router-dom';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Product from '../../components/Product';\nimport Advertisement from '../../components/Advertisement';\nimport MySpinner from '../../components/MySpinner';\nimport './styles.css';\nimport { loadProducts } from '../../store/actions/products';\nimport { setPageToLoad } from '../../store/actions/header';\nimport { config } from '../../services/config';\n\nconst Products = ({\n  products: {\n    isLoading,\n    products,\n    hasMoreItems,\n    error\n  },\n  loadProducts,\n  header,\n  setPageToLoad\n}) => {\n  // did mount\n  useEffect(() => {\n    loadProducts({\n      page: {\n        index: 0,\n        size: config.pageSize\n      },\n      sort: {\n        key: 'none',\n        direction: 'asc'\n      },\n      filter: {\n        brand: 'none',\n        color: 'none'\n      }\n    }, false);\n  }, []);\n\n  function fetchMoreData(pageToLoad) {\n    // console.log('pageToLoad: ', pageToLoad);\n    if (pageToLoad > 0) {\n      loadProducts({\n        page: {\n          index: (header.pageToLoad + 1) * config.pageSize,\n          size: config.pageSize\n        },\n        sort: _objectSpread({}, header.sortBy),\n        filter: _objectSpread({}, header.filterBy)\n      }, true, () => setPageToLoad(header.pageToLoad + 1) // this way or race loop!!!\n      ); //console.log('header.pageToLoad: ', header.pageToLoad);\n    }\n  } //console.log(products);\n\n\n  if (error) return React.createElement(Redirect, {\n    to: '/error',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  });\n  if (isLoading) return React.createElement(MySpinner, {\n    key: 0,\n    text: 'Loading...',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  });\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(InfiniteScroll, {\n    className: \"row\",\n    pageStart: 0,\n    loadMore: fetchMoreData,\n    hasMore: hasMoreItems,\n    initialLoad: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, products.map((product, i) => product.isAdvert ? React.createElement(Advertisement, Object.assign({}, product, {\n    key: i,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  })) : React.createElement(Product, {\n    product: product,\n    key: i,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }))), !error && !hasMoreItems && React.createElement(Row, {\n    className: \"mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, React.createElement(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, \"No more products\"))));\n};\n\nexport default connect(state => ({\n  products: state.productsReducer,\n  header: state.headerReducer\n}), {\n  loadProducts,\n  setPageToLoad\n})(Products);","map":{"version":3,"sources":["/Applications/MAMP/htdocs/react-lure-cart/src/pages/Products/Products.js"],"names":["React","useEffect","useState","useRef","Fragment","connect","InfiniteScroll","Redirect","Row","Col","Product","Advertisement","MySpinner","loadProducts","setPageToLoad","config","Products","products","isLoading","hasMoreItems","error","header","page","index","size","pageSize","sort","key","direction","filter","brand","color","fetchMoreData","pageToLoad","sortBy","filterBy","map","product","i","isAdvert","state","productsReducer","headerReducer"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Redirect } from 'react-router-dom';\n\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nimport Product from '../../components/Product';\nimport Advertisement from '../../components/Advertisement';\nimport MySpinner from '../../components/MySpinner';\nimport './styles.css';\n\nimport { loadProducts } from '../../store/actions/products';\nimport { setPageToLoad } from '../../store/actions/header';\n\nimport { config } from '../../services/config';\n\nconst Products = ({\n  products: { isLoading, products, hasMoreItems, error },\n  loadProducts,\n  header,\n  setPageToLoad,\n}) => {\n  // did mount\n  useEffect(() => {\n    loadProducts(\n      {\n        page: { index: 0, size: config.pageSize },\n        sort: { key: 'none', direction: 'asc' },\n        filter: { brand: 'none', color: 'none' },\n      },\n      false,\n    );\n  }, []);\n\n  function fetchMoreData(pageToLoad) {\n    // console.log('pageToLoad: ', pageToLoad);\n    if (pageToLoad > 0) {\n      loadProducts(\n        {\n          page: {\n            index: (header.pageToLoad + 1) * config.pageSize,\n            size: config.pageSize,\n          },\n          sort: { ...header.sortBy },\n          filter: { ...header.filterBy },\n        },\n        true,\n        () => setPageToLoad(header.pageToLoad + 1), // this way or race loop!!!\n      );\n      //console.log('header.pageToLoad: ', header.pageToLoad);\n    }\n  }\n\n  //console.log(products);\n  if (error) return <Redirect to={'/error'} />;\n  if (isLoading) return <MySpinner key={0} text={'Loading...'} />;\n\n  return (\n    <Fragment>\n      <InfiniteScroll\n        className=\"row\"\n        pageStart={0}\n        loadMore={fetchMoreData}\n        hasMore={hasMoreItems}\n        initialLoad={false}\n      >\n        {products.map((product, i) =>\n          product.isAdvert ? (\n            <Advertisement {...product} key={i} />\n          ) : (\n            <Product product={product} key={i} />\n          ),\n        )}\n      </InfiniteScroll>\n      {!error && !hasMoreItems && (\n        <Row className=\"mb-3\">\n          <Col>\n            <h4 className=\"text-center\">No more products</h4>\n          </Col>\n        </Row>\n      )}\n    </Fragment>\n  );\n};\n\nexport default connect(\n  state => ({\n    products: state.productsReducer,\n    header: state.headerReducer,\n  }),\n  { loadProducts, setPageToLoad },\n)(Products);\n"]},"metadata":{},"sourceType":"module"}